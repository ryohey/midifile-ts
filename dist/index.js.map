{"version":3,"file":"index.js","sources":["../src/constants/MIDIChannelEvents.ts","../src/constants/MIDIControlEventNames.ts","../src/constants/MIDIControlEvents.ts","../src/constants/MIDIMetaEventNames.ts","../src/constants/MIDIMetaEvents.ts","../src/deserialize.ts","../src/stream.ts","../src/read.ts","../src/toCharCodes.ts","../src/vlq.ts","../src/serialize.ts","../src/buffer.ts","../src/write.ts"],"sourcesContent":["export const MIDIChannelEvents = {\n  noteOff: 0x08,\n  noteOn: 0x09,\n  noteAftertouch: 0x0a,\n  controller: 0x0b,\n  programChange: 0x0c,\n  channelAftertouch: 0x0d,\n  pitchBend: 0x0e,\n} as const\n","export const MIDIControlEventNames = [\n  \"Bank Select\",\n  \"Modulation\",\n  \"Breath Controller\",\n  \"Foot Pedal\",\n  \"Portamento Time\",\n  \"Data Entry\",\n  \"Volume\",\n  \"Balance\",\n  \"Pan\",\n  \"Expression\",\n  \"Effect Control 1\",\n  \"Effect Control 2\",\n  \"Undefined\",\n  \"Undefined\",\n  \"General Purpose Slider 1\",\n  \"General Purpose Slider 2\",\n  \"General Purpose Slider 3\",\n  \"Knob 2 General Purpose Slider 4\",\n  \"Knob 3\",\n  \"Knob 4\",\n  \"Bank Select\",\n  \"Modulation Wheel\",\n  \"Breath controller\",\n  \"Foot Pedal\",\n  \"Portamento Time\",\n  \"Data Entry\",\n  \"Volume\",\n  \"Balance\",\n  \"Pan position\",\n  \"Expression\",\n  \"Effect Control 1\",\n  \"Effect Control 2\",\n  \"Hold Pedal\",\n  \"Portamento\",\n  \"Sustenuto Pedal\",\n  \"Soft Pedal\",\n  \"Legato Pedal\",\n  \"Hold 2 Pedal\",\n  \"Sound Variation\",\n  \"Resonance\",\n  \"Sound Release Time\",\n  \"Sound Attack Time\",\n  \"Frequency Cutoff\",\n  \"Sound Control 6\",\n  \"Sound Control 7\",\n  \"Sound Control 8\",\n  \"Sound Control 9\",\n  \"Sound Control 10\",\n  \"Decay\",\n  \"High Pass Filter Frequency\",\n  \"General Purpose Button 3\",\n  \"General Purpose Button 4\",\n  \"Reverb Level\",\n  \"Tremolo Level\",\n  \"Chorus Level\",\n  \"Detune\",\n  \"Phaser Level\",\n  \"Data Button Increment\",\n  \"Data Button Decrement\",\n  \"NRPN (LSB)\",\n  \"NRPN (MSB)\",\n  \"RPN (LSB)\",\n  \"RPN (MSB)\",\n  \"All Sound Off\",\n  \"All Controllers Off\",\n  \"Local Keyboard\",\n  \"All Notes Off\",\n  \"Omni Mode Off\",\n  \"Omni Mode On\",\n  \"Mono Operation\",\n  \"Poly Operation\",\n] as const\n","export const MIDIControlEvents = {\n  MSB_BANK: 0x00,\n  MSB_MODWHEEL: 0x01,\n  MSB_BREATH: 0x02,\n  MSB_FOOT: 0x04,\n  MSB_PORTAMENTO_TIME: 0x05,\n  MSB_DATA_ENTRY: 0x06,\n  MSB_MAIN_VOLUME: 0x07,\n  MSB_BALANCE: 0x08,\n  MSB_PAN: 0x0a,\n  MSB_EXPRESSION: 0x0b,\n  MSB_EFFECT1: 0x0c,\n  MSB_EFFECT2: 0x0d,\n  MSB_GENERAL_PURPOSE1: 0x10,\n  MSB_GENERAL_PURPOSE2: 0x11,\n  MSB_GENERAL_PURPOSE3: 0x12,\n  MSB_GENERAL_PURPOSE4: 0x13,\n  LSB_BANK: 0x20,\n  LSB_MODWHEEL: 0x21,\n  LSB_BREATH: 0x22,\n  LSB_FOOT: 0x24,\n  LSB_PORTAMENTO_TIME: 0x25,\n  LSB_DATA_ENTRY: 0x26,\n  LSB_MAIN_VOLUME: 0x27,\n  LSB_BALANCE: 0x28,\n  LSB_PAN: 0x2a,\n  LSB_EXPRESSION: 0x2b,\n  LSB_EFFECT1: 0x2c,\n  LSB_EFFECT2: 0x2d,\n  LSB_GENERAL_PURPOSE1: 0x30,\n  LSB_GENERAL_PURPOSE2: 0x31,\n  LSB_GENERAL_PURPOSE3: 0x32,\n  LSB_GENERAL_PURPOSE4: 0x33,\n  SUSTAIN: 0x40,\n  PORTAMENTO: 0x41,\n  SOSTENUTO: 0x42,\n  SUSTENUTO: 0x42,\n  SOFT_PEDAL: 0x43,\n  LEGATO_FOOTSWITCH: 0x44,\n  HOLD2: 0x45,\n  SC1_SOUND_VARIATION: 0x46,\n  SC2_TIMBRE: 0x47,\n  SC3_RELEASE_TIME: 0x48,\n  SC4_ATTACK_TIME: 0x49,\n  SC5_BRIGHTNESS: 0x4a,\n  SC6: 0x4b,\n  SC7: 0x4c,\n  SC8: 0x4d,\n  SC9: 0x4e,\n  SC10: 0x4f,\n  GENERAL_PURPOSE5: 0x50,\n  GENERAL_PURPOSE6: 0x51,\n  GENERAL_PURPOSE7: 0x52,\n  GENERAL_PURPOSE8: 0x53,\n  PORTAMENTO_CONTROL: 0x54,\n  E1_REVERB_DEPTH: 0x5b,\n  E2_TREMOLO_DEPTH: 0x5c,\n  E3_CHORUS_DEPTH: 0x5d,\n  E4_DETUNE_DEPTH: 0x5e,\n  E5_PHASER_DEPTH: 0x5f,\n  DATA_INCREMENT: 0x60,\n  DATA_DECREMENT: 0x61,\n  NONREG_PARM_NUM_LSB: 0x62,\n  NONREG_PARM_NUM_MSB: 0x63,\n  REGIST_PARM_NUM_LSB: 0x64,\n  REGIST_PARM_NUM_MSB: 0x65,\n  ALL_SOUNDS_OFF: 0x78,\n  RESET_CONTROLLERS: 0x79,\n  LOCAL_CONTROL_SWITCH: 0x7a,\n  ALL_NOTES_OFF: 0x7b,\n  OMNI_OFF: 0x7c,\n  OMNI_ON: 0x7d,\n  MONO1: 0x7e,\n  MONO2: 0x7f,\n} as const\n","export const MIDIMetaEventNames = {\n  0x00: \"sequenceNumber\",\n  0x01: \"text\",\n  0x02: \"copyrightNotice\",\n  0x03: \"trackName\",\n  0x04: \"instrumentName\",\n  0x05: \"lyrics\",\n  0x06: \"marker\",\n  0x07: \"cuePoint\",\n  0x20: \"midiChannelPrefix\",\n  0x21: \"portPrefix\",\n  0x2f: \"endOfTrack\",\n  0x51: \"setTempo\",\n  0x54: \"smpteOffset\",\n  0x58: \"timeSignature\",\n  0x59: \"keySignature\",\n  0x7f: \"sequencerSpecific\",\n} as const\n","export const MIDIMetaEvents = {\n  sequenceNumber: 0x00,\n  text: 0x01,\n  copyrightNotice: 0x02,\n  trackName: 0x03,\n  instrumentName: 0x04,\n  lyrics: 0x05,\n  marker: 0x06,\n  cuePoint: 0x07,\n  midiChannelPrefix: 0x20,\n  portPrefix: 0x21,\n  endOfTrack: 0x2f,\n  setTempo: 0x51,\n  smpteOffset: 0x54,\n  timeSignature: 0x58,\n  keySignature: 0x59,\n  sequencerSpecific: 0x7f,\n} as const\n","import { MIDIChannelEvents } from \".\"\nimport { MIDIMetaEvents } from \"./constants/MIDIMetaEvents\"\nimport {\n  AnyEvent,\n  ChannelAftertouchEvent,\n  ChannelPrefixEvent,\n  ControllerEvent,\n  CopyrightNoticeEvent,\n  CuePointEvent,\n  DividedSysExEvent,\n  EndOfTrackEvent,\n  InstrumentNameEvent,\n  KeySignatureEvent,\n  LyricsEvent,\n  MarkerEvent,\n  NoteAftertouchEvent,\n  NoteOffEvent,\n  NoteOnEvent,\n  PitchBendEvent,\n  PortPrefixEvent,\n  ProgramChangeEvent,\n  SequenceNumberEvent,\n  SequencerSpecificEvent,\n  SetTempoEvent,\n  SmpteOffsetEvent,\n  SysExEvent,\n  TextEvent,\n  TimeSignatureEvent,\n  TrackNameEvent,\n  UnknownChannelEvent,\n  UnknownMetaEvent,\n} from \"./event\"\nimport { Stream } from \"./stream\"\n\nexport function deserialize(\n  stream: Stream,\n  lastEventTypeByte: number = 0,\n  setLastEventTypeByte?: (eventType: number) => void\n): AnyEvent {\n  const deltaTime = stream.readVarInt()\n  return deserializeSingleEvent(\n    stream,\n    deltaTime,\n    lastEventTypeByte,\n    setLastEventTypeByte\n  )\n}\n\nexport function deserializeSingleEvent(\n  stream: Stream,\n  deltaTime: number = 0,\n  lastEventTypeByte: number = 0,\n  setLastEventTypeByte?: (eventType: number) => void\n) {\n  let eventTypeByte = stream.readInt8()\n  if ((eventTypeByte & 0xf0) === 0xf0) {\n    /* system / meta event */\n    if (eventTypeByte === 0xff) {\n      /* meta event */\n      const type = \"meta\"\n      const subtypeByte = stream.readInt8()\n      const length = stream.readVarInt()\n      switch (subtypeByte) {\n        case MIDIMetaEvents.sequenceNumber:\n          if (length !== 2)\n            throw new Error(\n              \"Expected length for sequenceNumber event is 2, got \" + length\n            )\n          return <SequenceNumberEvent>{\n            deltaTime,\n            type,\n            subtype: \"sequenceNumber\",\n            number: stream.readInt16(),\n          }\n        case MIDIMetaEvents.text:\n          return <TextEvent>{\n            deltaTime,\n            type,\n            subtype: \"text\",\n            text: stream.readStr(length),\n          }\n        case MIDIMetaEvents.copyrightNotice:\n          return <CopyrightNoticeEvent>{\n            deltaTime,\n            type,\n            subtype: \"copyrightNotice\",\n            text: stream.readStr(length),\n          }\n        case MIDIMetaEvents.trackName:\n          return <TrackNameEvent>{\n            deltaTime,\n            type,\n            subtype: \"trackName\",\n            text: stream.readStr(length),\n          }\n        case MIDIMetaEvents.instrumentName:\n          return <InstrumentNameEvent>{\n            deltaTime,\n            type,\n            subtype: \"instrumentName\",\n            text: stream.readStr(length),\n          }\n        case MIDIMetaEvents.lyrics:\n          return <LyricsEvent>{\n            deltaTime,\n            type,\n            subtype: \"lyrics\",\n            text: stream.readStr(length),\n          }\n        case MIDIMetaEvents.marker:\n          return <MarkerEvent>{\n            deltaTime,\n            type,\n            subtype: \"marker\",\n            text: stream.readStr(length),\n          }\n        case MIDIMetaEvents.cuePoint:\n          return <CuePointEvent>{\n            deltaTime,\n            type,\n            subtype: \"cuePoint\",\n            text: stream.readStr(length),\n          }\n        case MIDIMetaEvents.midiChannelPrefix:\n          if (length !== 1)\n            throw new Error(\n              \"Expected length for midiChannelPrefix event is 1, got \" + length\n            )\n          return <ChannelPrefixEvent>{\n            deltaTime,\n            type,\n            subtype: \"midiChannelPrefix\",\n            value: stream.readInt8(),\n          }\n        case MIDIMetaEvents.portPrefix:\n          if (length !== 1)\n            throw new Error(\n              \"Expected length for midiChannelPrefix event is 1, got \" + length\n            )\n          return <PortPrefixEvent>{\n            deltaTime,\n            type,\n            subtype: \"portPrefix\",\n            port: stream.readInt8(),\n          }\n        case MIDIMetaEvents.endOfTrack:\n          if (length !== 0)\n            throw new Error(\n              \"Expected length for endOfTrack event is 0, got \" + length\n            )\n          return <EndOfTrackEvent>{\n            deltaTime,\n            type,\n            subtype: \"endOfTrack\",\n          }\n        case MIDIMetaEvents.setTempo:\n          if (length !== 3)\n            throw new Error(\n              \"Expected length for setTempo event is 3, got \" + length\n            )\n          return <SetTempoEvent>{\n            deltaTime,\n            type,\n            subtype: \"setTempo\",\n            microsecondsPerBeat:\n              (stream.readInt8() << 16) +\n              (stream.readInt8() << 8) +\n              stream.readInt8(),\n          }\n        case MIDIMetaEvents.smpteOffset: {\n          if (length !== 5)\n            throw new Error(\n              \"Expected length for smpteOffset event is 5, got \" + length\n            )\n          const hourByte = stream.readInt8()\n          const table: { [key: number]: number } = {\n            0x00: 24,\n            0x20: 25,\n            0x40: 29,\n            0x60: 30,\n          }\n          return <SmpteOffsetEvent>{\n            deltaTime,\n            type,\n            subtype: \"smpteOffset\",\n            frameRate: table[hourByte & 0x60],\n            hour: hourByte & 0x1f,\n            min: stream.readInt8(),\n            sec: stream.readInt8(),\n            frame: stream.readInt8(),\n            subframe: stream.readInt8(),\n          }\n        }\n        case MIDIMetaEvents.timeSignature:\n          if (length !== 4)\n            throw new Error(\n              \"Expected length for timeSignature event is 4, got \" + length\n            )\n          return <TimeSignatureEvent>{\n            deltaTime,\n            type,\n            subtype: \"timeSignature\",\n            numerator: stream.readInt8(),\n            denominator: Math.pow(2, stream.readInt8()),\n            metronome: stream.readInt8(),\n            thirtyseconds: stream.readInt8(),\n          }\n        case MIDIMetaEvents.keySignature:\n          if (length !== 2)\n            throw new Error(\n              \"Expected length for keySignature event is 2, got \" + length\n            )\n          return <KeySignatureEvent>{\n            deltaTime,\n            type,\n            subtype: \"keySignature\",\n            key: stream.readInt8(true),\n            scale: stream.readInt8(),\n          }\n        case MIDIMetaEvents.sequencerSpecific:\n          return <SequencerSpecificEvent>{\n            deltaTime,\n            type,\n            subtype: \"sequencerSpecific\",\n            data: stream.read(length),\n          }\n        default:\n          return <UnknownMetaEvent>{\n            deltaTime,\n            type,\n            subtype: \"unknown\",\n            data: stream.read(length),\n          }\n      }\n    } else if (eventTypeByte === 0xf0) {\n      const length = stream.readVarInt()\n      return <SysExEvent>{\n        deltaTime,\n        type: \"sysEx\",\n        data: stream.read(length),\n      }\n    } else if (eventTypeByte === 0xf7) {\n      const length = stream.readVarInt()\n      return <DividedSysExEvent>{\n        deltaTime,\n        type: \"dividedSysEx\",\n        data: stream.read(length),\n      }\n    } else {\n      throw new Error(\"Unrecognised MIDI event type byte: \" + eventTypeByte)\n    }\n  } else {\n    /* channel event */\n    let param1\n    if ((eventTypeByte & 0x80) === 0) {\n      /* running status - reuse lastEventTypeByte as the event type.\n        eventTypeByte is actually the first parameter\n      */\n      param1 = eventTypeByte\n      eventTypeByte = lastEventTypeByte\n    } else {\n      param1 = stream.readInt8()\n      setLastEventTypeByte?.(eventTypeByte)\n    }\n    const eventType = eventTypeByte >> 4\n    const channel = eventTypeByte & 0x0f\n    const type = \"channel\"\n    switch (eventType) {\n      case MIDIChannelEvents.noteOff:\n        return <NoteOffEvent>{\n          deltaTime,\n          type,\n          channel,\n          subtype: \"noteOff\",\n          noteNumber: param1,\n          velocity: stream.readInt8(),\n        }\n      case MIDIChannelEvents.noteOn: {\n        const velocity = stream.readInt8()\n        return <NoteOnEvent>{\n          deltaTime,\n          type,\n          channel,\n          subtype: velocity === 0 ? \"noteOff\" : \"noteOn\",\n          noteNumber: param1,\n          velocity: velocity,\n        }\n      }\n      case MIDIChannelEvents.noteAftertouch:\n        return <NoteAftertouchEvent>{\n          deltaTime,\n          type,\n          channel,\n          subtype: \"noteAftertouch\",\n          noteNumber: param1,\n          amount: stream.readInt8(),\n        }\n      case MIDIChannelEvents.controller:\n        return <ControllerEvent>{\n          deltaTime,\n          type,\n          channel,\n          subtype: \"controller\",\n          controllerType: param1,\n          value: stream.readInt8(),\n        }\n      case MIDIChannelEvents.programChange:\n        return <ProgramChangeEvent>{\n          deltaTime,\n          type,\n          channel,\n          subtype: \"programChange\",\n          value: param1,\n        }\n      case MIDIChannelEvents.channelAftertouch:\n        return <ChannelAftertouchEvent>{\n          deltaTime,\n          type,\n          channel,\n          subtype: \"channelAftertouch\",\n          amount: param1,\n        }\n      case MIDIChannelEvents.pitchBend:\n        return <PitchBendEvent>{\n          deltaTime,\n          type,\n          channel,\n          subtype: \"pitchBend\",\n          value: param1 + (stream.readInt8() << 7),\n        }\n      default:\n        return <UnknownChannelEvent>{\n          deltaTime,\n          type,\n          channel,\n          subtype: \"unknown\",\n          data: stream.readInt8(),\n        }\n    }\n  }\n}\n","export type StreamSource =\n  | DataView\n  | number[]\n  | ArrayBuffer\n  | Uint8Array\n\n/* Wrapper for accessing strings through sequential reads */\nexport class Stream {\n  private buf: DataView\n  private position = 0\n\n  constructor(buf: StreamSource) {\n    if (buf instanceof DataView) {\n      this.buf = buf\n    } else if (buf instanceof ArrayBuffer) {\n      this.buf = new DataView(buf)\n    } else if (buf instanceof Array) {\n      this.buf = new DataView(new Uint8Array(buf).buffer)\n    } else if (buf instanceof Uint8Array) {\n      this.buf = new DataView(buf.buffer)\n    } else {\n      throw new Error(\"not supported type: \" + typeof buf)\n    }\n  }\n\n  readByte() {\n    return this.buf.getUint8(this.position++)\n  }\n\n  readStr(length: number): string {\n    return this.read(length)\n      .map(e => String.fromCharCode(e))\n      .join(\"\")\n  }\n\n  read(length: number): number[] {\n    const result: number[] = []\n    for (let index = 0; index < length; index++) {\n      result.push(this.readByte())\n    }\n    return result\n  }\n\n  /* read a big-endian 32-bit integer */\n  readInt32(): number {\n    const result = this.buf.getInt32(this.position, false)\n    this.position += 4\n    return result\n  }\n\n  /* read a big-endian 16-bit integer */\n  readInt16(): number {\n    const result = this.buf.getInt16(this.position, false)\n    this.position += 2\n    return result\n  }\n\n  /* read an 8-bit integer */\n  readInt8(signed = false): number {\n    if (signed) {\n      return this.buf.getInt8(this.position++)\n    } else {\n      return this.readByte()\n    }\n  }\n\n  eof(): boolean {\n    return this.position >= this.buf.byteLength\n  }\n\n  /* read a MIDI-style variable-length integer\n    (big-endian value in groups of 7 bits,\n    with top bit set to signify that another byte follows)\n  */\n  readVarInt(): number {\n    let result = 0\n    for (;;) {\n      const b = this.readInt8()\n      if (b & 0x80) {\n        result += b & 0x7f\n        result <<= 7\n      } else {\n        /* b is the last byte */\n        return result + b\n      }\n    }\n  }\n}\n","import { deserialize } from \"./deserialize\"\nimport { AnyEvent } from \"./event\"\nimport { Stream, StreamSource } from \"./stream\"\n\nexport interface MidiHeader {\n  formatType: number\n  trackCount: number\n  ticksPerBeat: number\n}\n\nexport interface MidiFile {\n  header: MidiHeader\n  tracks: AnyEvent[][]\n}\n\n/*\nclass to parse the .mid file format\n(depends on stream.js)\n*/\nexport function read(data: StreamSource): MidiFile {\n  function readChunk(stream: Stream) {\n    const id = stream.readStr(4)\n    const length = stream.readInt32()\n    return {\n      id,\n      length,\n      data: stream.read(length),\n    }\n  }\n\n  const stream = new Stream(data)\n  const headerChunk = readChunk(stream)\n  if (headerChunk.id !== \"MThd\" || headerChunk.length !== 6) {\n    throw new Error(\"Bad .mid file - header not found\")\n  }\n  const headerStream = new Stream(headerChunk.data)\n  const formatType = headerStream.readInt16()\n  const trackCount = headerStream.readInt16()\n  const timeDivision = headerStream.readInt16()\n  let ticksPerBeat: number\n\n  if (timeDivision & 0x8000) {\n    throw new Error(\n      \"Expressing time division in SMTPE frames is not supported yet\"\n    )\n  } else {\n    ticksPerBeat = timeDivision\n  }\n\n  const header = {\n    formatType,\n    trackCount,\n    ticksPerBeat,\n  }\n\n  let lastEventTypeByte: number\n  function readEvent(stream: Stream): AnyEvent {\n    return deserialize(\n      stream,\n      lastEventTypeByte,\n      (byte) => (lastEventTypeByte = byte)\n    )\n  }\n\n  const tracks: AnyEvent[][] = []\n  for (let i = 0; i < header.trackCount; i++) {\n    tracks[i] = []\n    const trackChunk = readChunk(stream)\n    if (trackChunk.id !== \"MTrk\") {\n      throw new Error(\"Unexpected chunk - expected MTrk, got \" + trackChunk.id)\n    }\n    const trackStream = new Stream(trackChunk.data)\n    while (!trackStream.eof()) {\n      const event = readEvent(trackStream)\n      tracks[i].push(event)\n    }\n  }\n\n  return {\n    header,\n    tracks,\n  }\n}\n","export function toCharCodes(str: string): number[] {\n  const bytes: number[] = []\n  for (let i = 0; i < str.length; i++) {\n    bytes.push(str.charCodeAt(i))\n  }\n  return bytes\n}\n","// variable-length quantity\n\nexport function toVLQ(intNum: number): number[] {\n  let v = intNum\n  const r = [v & 0x7f]\n  while (true) {\n    v >>= 7\n    if (v === 0) {\n      break\n    }\n    r.unshift(0x80 + (v & 0x7f))\n  }\n  return r\n}\n\nexport const fromVLQ = (vlq: number[]): number => {\n  let result = 0\n  for (;;) {\n    const b = vlq.shift()\n    if (b === undefined) {\n      throw new Error(\"invalid vlq bytes\")\n    }\n    if (b & 0x80) {\n      result += b & 0x7f\n      result <<= 7\n    } else {\n      /* b is the last byte */\n      return result + b\n    }\n  }\n}\n","import { MIDIChannelEvents } from \"./constants/MIDIChannelEvents\"\nimport { MIDIMetaEvents } from \"./constants/MIDIMetaEvents\"\nimport { AnyEvent } from \"./event\"\nimport { toCharCodes } from \"./toCharCodes\"\nimport { toVLQ } from \"./vlq\"\n\nexport function serialize(e: AnyEvent, includeDeltaTime = true) {\n  const bytes: number[] = []\n\n  function add(data: number | number[]) {\n    if (Array.isArray(data)) {\n      data.forEach(add)\n    } else {\n      if (!Number.isInteger(data)) {\n        throw new Error(`\"${data}\" is not integer`)\n      }\n      bytes.push(data)\n    }\n  }\n\n  if (includeDeltaTime) {\n    add(toVLQ(e.deltaTime))\n  }\n\n  function addNumbers(list: number[]) {\n    add(list.length)\n    list.forEach((v) => add(v))\n  }\n\n  function addText(text: string) {\n    add(text.length)\n    add(toCharCodes(text))\n  }\n\n  switch (e.type) {\n    case \"meta\": {\n      const subtypeCode = MIDIMetaEvents[e.subtype]\n      if (subtypeCode === undefined) {\n        return []\n      }\n      add(0xff) // type\n      add(subtypeCode) // subtype\n      switch (e.subtype) {\n        case \"sequenceNumber\":\n          add(e.number)\n          break\n        case \"text\":\n          addText(e.text)\n          break\n        case \"copyrightNotice\":\n          addText(e.text)\n          break\n        case \"trackName\":\n          addText(e.text)\n          break\n        case \"instrumentName\":\n          addText(e.text)\n          break\n        case \"lyrics\":\n          addText(e.text)\n          break\n        case \"marker\":\n          addText(e.text)\n          break\n        case \"cuePoint\":\n          addText(e.text)\n          break\n        case \"midiChannelPrefix\":\n          addNumbers([e.value])\n          break\n        case \"portPrefix\":\n          addNumbers([e.port])\n          break\n        case \"endOfTrack\":\n          add(0)\n          break\n        case \"setTempo\": {\n          const t = e.microsecondsPerBeat\n          addNumbers([(t >> 16) & 0xff, (t >> 8) & 0xff, t & 0xff])\n          break\n        }\n        case \"smpteOffset\": {\n          const frameRateByte = {\n            24: 0x00,\n            25: 0x20,\n            29: 0x40,\n            30: 0x60,\n          }\n          addNumbers([\n            frameRateByte[e.frameRate] + (0x1f & e.hour),\n            e.min,\n            e.sec,\n            e.frame,\n            e.subframe,\n          ])\n          break\n        }\n        case \"timeSignature\": {\n          addNumbers([\n            e.numerator,\n            Math.log2(e.denominator),\n            e.metronome,\n            e.thirtyseconds,\n          ])\n          break\n        }\n        case \"keySignature\": {\n          addNumbers([e.key, e.scale])\n          break\n        }\n        case \"sequencerSpecific\":\n          addNumbers(e.data)\n          break\n        case \"unknown\":\n          addNumbers(e.data)\n          break\n      }\n      break\n    }\n    case \"sysEx\":\n      add(0xf0)\n      addNumbers(e.data)\n      break\n    case \"dividedSysEx\":\n      add(0xf7)\n      addNumbers(e.data)\n      break\n    case \"channel\": {\n      const subtypeCode = MIDIChannelEvents[e.subtype]\n      if (subtypeCode === undefined) {\n        return []\n      }\n      add((subtypeCode << 4) + e.channel) // subtype + channel\n      switch (e.subtype) {\n        case \"noteOff\": {\n          add(e.noteNumber)\n          add(e.velocity)\n          break\n        }\n        case \"noteOn\": {\n          add(e.noteNumber)\n          add(e.velocity)\n          break\n        }\n        case \"noteAftertouch\": {\n          add(e.noteNumber)\n          add(e.amount)\n          break\n        }\n        case \"controller\": {\n          add(e.controllerType)\n          add(e.value)\n          break\n        }\n        case \"programChange\":\n          add(e.value)\n          break\n        case \"channelAftertouch\":\n          add(e.amount)\n          break\n        case \"pitchBend\": {\n          add(e.value & 0x7f)\n          add((e.value >> 7) & 0x7f)\n          break\n        }\n        case \"unknown\":\n          add(e.data)\n          break\n      }\n      break\n    }\n  }\n\n  return bytes\n}\n","import { toCharCodes } from \"./toCharCodes\"\n\nexport class Buffer {\n  private data: number[] = []\n  private position: number = 0\n\n  get length() {\n    return this.data.length\n  }\n\n  writeByte(v: number) {\n    this.data.push(v)\n    this.position++\n  }\n\n  writeStr(str: string) {\n    this.writeBytes(toCharCodes(str))\n  }\n\n  writeInt32(v: number) {\n    this.writeByte((v >> 24) & 0xff)\n    this.writeByte((v >> 16) & 0xff)\n    this.writeByte((v >> 8) & 0xff)\n    this.writeByte(v & 0xff)\n  }\n\n  writeInt16(v: number) {\n    this.writeByte((v >> 8) & 0xff)\n    this.writeByte(v & 0xff)\n  }\n\n  writeBytes(arr: number[]) {\n    arr.forEach(v => this.writeByte(v))\n  }\n\n  writeChunk(id: string, func: (buf: Buffer) => void) {\n    this.writeStr(id)\n\n    const chunkBuf = new Buffer()\n    func(chunkBuf)\n\n    this.writeInt32(chunkBuf.length)\n    this.writeBytes(chunkBuf.data)\n  }\n\n  toBytes() {\n    return new Uint8Array(this.data)\n  }\n}\n","import { Buffer } from \"./buffer\"\nimport { AnyEvent } from \"./event\"\nimport { serialize } from \"./serialize\"\n\n//https://sites.google.com/site/yyagisite/material/smfspec#format\n\nexport function write(tracks: AnyEvent[][], ticksPerBeat = 480) {\n  const buf = new Buffer()\n\n  // header chunk\n  buf.writeChunk(\"MThd\", (it) => {\n    it.writeInt16(1) // formatType\n    it.writeInt16(tracks.length) // trackCount\n    it.writeInt16(ticksPerBeat) // timeDivision\n  })\n\n  // track chunk\n  for (const track of tracks) {\n    buf.writeChunk(\"MTrk\", (it) => {\n      for (const event of track) {\n        it.writeBytes(serialize(event))\n      }\n    })\n  }\n\n  return buf.toBytes()\n}\n"],"names":[],"mappings":"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"}